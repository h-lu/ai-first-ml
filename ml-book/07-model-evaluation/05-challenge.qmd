# 7.5 Challenge & Toolbox

## ç¬¬ä¸€éƒ¨åˆ†ï¼šåŠ¨æ‰‹æŒ‘æˆ˜ - æˆä¸º'ç‚¼ä¸¹'è‰ºæœ¯å®¶â€”â€”åˆæ¢è¶…å‚æ•°è°ƒä¼˜

åœ¨ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬è§è¯äº†LightGBMçš„å¼ºå¤§å¨åŠ›ï¼Œå®ƒçš„æ€§èƒ½è¿œè¶…é€»è¾‘å›å½’ã€‚ä½†æˆ‘ä»¬æ‰€ç”¨çš„ï¼Œåªæ˜¯ä¸€ä¸ª"å¼€ç®±å³ç”¨"çš„ã€ä½¿ç”¨é»˜è®¤å‚æ•°çš„LightGBMã€‚

åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œæå‡æ¨¡å‹æ€§èƒ½çš„æœ€åï¼ˆä¹Ÿå¾€å¾€æ˜¯æœ€æœ‰æ•ˆï¼‰ä¸€å…¬é‡Œï¼Œå¸¸å¸¸æ¥è‡ªäºå¯¹æ¨¡å‹**è¶…å‚æ•°ï¼ˆHyperparametersï¼‰**çš„ç²¾ç»†è°ƒæ•´ã€‚è¿™ä¸ªè¿‡ç¨‹å……æ»¡äº†å®éªŒå’Œæ¢ç´¢ï¼Œå› æ­¤è¢«å·¥ç¨‹å¸ˆä»¬æˆç§°ä¸º"ç‚¼ä¸¹"ã€‚

ä½ çš„æŒ‘æˆ˜æ˜¯ï¼šåœ¨AIçš„æŒ‡å¯¼ä¸‹ï¼Œæ‰®æ¼”ä¸€å›"ç‚¼ä¸¹å¸ˆ"ï¼Œå¯¹æˆ‘ä»¬çš„LightGBMæ¨¡å‹è¿›è¡Œä½ çš„ç¬¬ä¸€æ¬¡è¶…å‚æ•°è°ƒä¼˜ã€‚

#### ä»»åŠ¡1ï¼šAIï¼Œä»€ä¹ˆæ˜¯"ç‚¼ä¸¹ç‚‰"çš„"æ—‹é’®"ï¼Ÿ

åœ¨"ç‚¼ä¸¹"ä¹‹å‰ï¼Œä½ å¿…é¡»å…ˆç†è§£"ç‚¼ä¸¹ç‚‰"ä¸Šé‚£äº›å¤æ‚æ—‹é’®çš„å«ä¹‰ã€‚

**ğŸ‘‰ ä½ çš„æŒ‡ä»¤å‰§æœ¬ï¼š**

> æˆ‘æ­£åœ¨ä½¿ç”¨LightGBMæ¨¡å‹ï¼Œå¹¶å‡†å¤‡å¯¹å®ƒè¿›è¡Œè¶…å‚æ•°è°ƒä¼˜ã€‚æˆ‘æ³¨æ„åˆ°äº†è¿™ä¸‰ä¸ªå‚æ•°ï¼š`n_estimators`ï¼Œ`learning_rate` å’Œ `num_leaves`ã€‚
> 
> è¯·ä½ ç”¨ä¸€ä¸ªç”ŸåŠ¨çš„æ¯”å–»ï¼ˆæ¯”å¦‚æŠŠæ¨¡å‹è®­ç»ƒæ¯”ä½œ"å­¦ç”Ÿå­¦ä¹ "ï¼‰ï¼Œå‘æˆ‘è§£é‡Šè¿™ä¸‰ä¸ªè¶…å‚æ•°åˆ†åˆ«æ§åˆ¶äº†å­¦ä¹ è¿‡ç¨‹çš„å“ªä¸ªæ–¹é¢ï¼Ÿå®ƒä»¬è°ƒå¾—å¤ªé«˜æˆ–å¤ªä½ï¼Œåˆ†åˆ«ä¼šæœ‰ä»€ä¹ˆæ•ˆæœæˆ–é£é™©ï¼ˆæ¯”å¦‚"å­¦å¾—å¤ªæ…¢"æˆ–"æ­»è®°ç¡¬èƒŒ"ï¼‰ï¼Ÿ

ç†è§£äº†è¿™äº›ï¼Œä½ æ‰èƒ½åšå‡ºæœ‰æ ¹æ®çš„è°ƒæ•´ï¼Œè€Œä¸æ˜¯ç›²ç›®å°è¯•ã€‚

#### ä»»åŠ¡2ï¼šåŠ¨æ‰‹"è°ƒå‚"ï¼Œè§‚å¯Ÿç«ç„°çš„å˜åŒ–

ç°åœ¨ï¼Œè®©æˆ‘ä»¬äº²æ‰‹æ‹§åŠ¨ä¸€ä¸ª"æ—‹é’®"ï¼Œçœ‹çœ‹"ç«ç„°"ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ã€‚æˆ‘ä»¬å°†ä» `num_leaves` å¼€å§‹ï¼Œå®ƒæ§åˆ¶äº†æ¨¡å‹èƒ½å­¦ä¹ åˆ°çš„"è§„åˆ™"çš„å¤æ‚åº¦ã€‚

**ğŸ‘‰ ä½ çš„æŒ‡ä»¤å‰§æœ¬ï¼š**

> æ„Ÿè°¢ä½ çš„è§£é‡Šï¼æˆ‘ç°åœ¨æƒ³åŠ¨æ‰‹å®éªŒä¸€ä¸‹ `num_leaves` è¿™ä¸ªè¶…å‚æ•°ã€‚
> 
> è¯·å¸®æˆ‘ç¼–å†™ä¸€æ®µPythonä»£ç ï¼Œå®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š
> 
> 1.  åˆ›å»ºä¸€ä¸ª `num_leaves` çš„å€™é€‰å€¼åˆ—è¡¨ï¼Œä¾‹å¦‚ `[10, 20, 31, 40, 50]`ã€‚
> 2.  ç¼–å†™ä¸€ä¸ª`for`å¾ªç¯ï¼Œéå†è¿™ä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå€¼ã€‚
> 3.  åœ¨å¾ªç¯å†…éƒ¨ï¼Œåˆ›å»ºã€è®­ç»ƒä¸€ä¸ªæ–°çš„LightGBMæ¨¡å‹ï¼Œå¹¶å°†å½“å‰çš„å€™é€‰å€¼èµ‹ç»™ `num_leaves` å‚æ•°ã€‚
> 4.  åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°è¯¥æ¨¡å‹ï¼Œå¹¶æ‰“å°å‡ºå½“å‰çš„ `num_leaves` å€¼å’Œå®ƒå¯¹åº”çš„F1åˆ†æ•°ã€‚
> 
> æˆ‘æƒ³é€šè¿‡è¿™ä¸ªå®éªŒï¼Œæ‰¾åˆ°åœ¨å½“å‰ä»»åŠ¡ä¸­ï¼Œ`num_leaves` çš„æœ€ä½³å–å€¼èŒƒå›´ã€‚

#### ä»»åŠ¡3ï¼šæ€è¾¨ï¼šè°ƒå‚æ˜¯"ä¸‡èƒ½çµè¯"å—ï¼Ÿ

è°ƒå‚éå¸¸å¼ºå¤§ï¼Œä½†ä¹Ÿå®¹æ˜“è®©äººé™·å…¥ä¸€ä¸ªè¯¯åŒºï¼šç›²ç›®è¿½æ±‚åˆ†æ•°çš„æå‡ï¼Œè€Œå¿½ç•¥äº†å…¶èƒŒåçš„ä»£ä»·å’Œé£é™©ã€‚

**ğŸ‘‰ ä¸AIè¿›è¡Œä¸€åœºæ€è¾¨å¯¹è¯ï¼š**

> æˆ‘å‘ç°é€šè¿‡è°ƒä¼˜è¶…å‚æ•°ï¼Œç¡®å®å¯ä»¥æå‡æ¨¡å‹çš„F1åˆ†æ•°ã€‚è¿™è®©æˆ‘å¾ˆå…´å¥‹ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›ç–‘é—®ã€‚è¯·å’Œæˆ‘æ¢è®¨ä¸€ä¸‹ï¼š
> 
> 1.  æ˜¯ä¸æ˜¯è¶…å‚æ•°è°ƒä¼˜çš„è¿‡ç¨‹è¶Šå¤æ‚ã€æœç´¢çš„å€™é€‰å€¼è¶Šå¤šï¼Œæœ€ç»ˆå¾—åˆ°çš„æ¨¡å‹å°±ä¸€å®šè¶Šå¥½ï¼Ÿ
> 2.  è¿™ä¸ªè¿‡ç¨‹æœ‰æ²¡æœ‰å¯èƒ½å¸¦æ¥ä»€ä¹ˆè´Ÿé¢æ•ˆæœï¼Ÿæ¯”å¦‚ï¼Œæˆ‘å¬è¯´è¿‡ä¸€ä¸ªè¯å«"è¿‡æ‹Ÿåˆåˆ°éªŒè¯é›†ä¸Š"ï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå®ƒåœ¨æˆ‘ä»¬çš„è°ƒå‚è¿‡ç¨‹ä¸­æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Ÿ
> 3.  é™¤äº†æå‡æ¨¡å‹åˆ†æ•°ï¼Œè¶…å‚æ•°è°ƒä¼˜è¿˜æœ‰æ²¡æœ‰å…¶ä»–æˆ‘ä»¬åº”è¯¥å…³æ³¨çš„ç›®æ ‡ï¼Ÿï¼ˆæ¯”å¦‚æ¨¡å‹çš„è®­ç»ƒé€Ÿåº¦ã€é¢„æµ‹é€Ÿåº¦ç­‰ï¼‰

è¿™ä¸ªæ€è¾¨å°†è®©ä½ å¯¹æ¨¡å‹ä¼˜åŒ–æœ‰ä¸€ä¸ªæ›´æˆç†Ÿã€æ›´å…¨é¢çš„è®¤è¯†ï¼Œè€Œä¸ä»…ä»…æ˜¯ç›¯ç€è¯„ä¼°æŒ‡æ ‡ã€‚

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šAIååŒå·¥å…·ç®± - ç³»ç»ŸåŒ–ä½ çš„æ¨¡å‹å®éªŒ

### ä»"ä¸€æ¬¡æ€§è„šæœ¬"åˆ°"å¯è¿½æº¯çš„ç§‘å­¦å®éªŒ"

åœ¨ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬åŸºäºåˆ†æç»“æœï¼Œæå‡ºäº†å¤šä¸ªæ¨¡å‹è¿­ä»£çš„å‡è®¾ï¼š
-   å°è¯•æ–°ç®—æ³•ï¼Œå¦‚LightGBMã€‚
-   è°ƒæ•´æ¨¡å‹å‚æ•°ã€‚
-   ä½¿ç”¨ä¸åŒçš„ç‰¹å¾å·¥ç¨‹æ–¹æ³•ã€‚
-   å¤„ç†ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ã€‚

å¾ˆå¿«ï¼Œä½ å°±ä¼šå‘ç°è‡ªå·±é™·å…¥äº†ä¸€ä¸ªæ–°çš„å›°å¢ƒï¼š
-   ä½ å°è¯•äº†10ä¸ªä¸åŒçš„æ¨¡å‹ï¼Œå“ªä¸ªæ•ˆæœæœ€å¥½æ¥ç€ï¼Ÿ
-   æ¨¡å‹Aåœ¨"æœ‰å®³"ç±»åˆ«ä¸Šå¬å›ç‡é«˜ï¼Œä½†æ¨¡å‹Båœ¨"ä½è´¨"ç±»åˆ«ä¸Šç²¾ç¡®ç‡é«˜ï¼Œå¦‚ä½•å–èˆï¼Ÿ
-   æˆ‘ä¸‰ä¸ªæœˆå‰åšçš„é‚£ä¸ªæ•ˆæœä¸é”™çš„å®éªŒï¼Œå‚æ•°åˆ°åº•æ˜¯æ€ä¹ˆè®¾ç½®çš„ï¼Ÿ

å¦‚æœä½ çš„æ‰€æœ‰å®éªŒéƒ½åªæ˜¯ä¸€äº›æ•£ä¹±çš„Jupyter Notebookæˆ–Pythonè„šæœ¬ï¼Œé‚£ä¹ˆä½ çš„é¡¹ç›®å¾ˆå¿«å°±ä¼šå˜å¾—æ··ä¹±ä¸å ªã€æ— æ³•ç®¡ç†ã€‚

ç§‘å­¦çš„è¿›æ­¥ä¾èµ–äº**å¯å¤ç°çš„å®éªŒ**ã€‚æœºå™¨å­¦ä¹ ä½œä¸ºä¸€é—¨å®éªŒç§‘å­¦ï¼ŒåŒæ ·å¦‚æ­¤ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå·¥å…·æ¥ç³»ç»Ÿåœ°ç®¡ç†æˆ‘ä»¬çš„å®éªŒè¿‡ç¨‹ï¼Œè¿™å°±æ˜¯**å®éªŒè·Ÿè¸ªï¼ˆExperiment Trackingï¼‰**ã€‚

### ä»€ä¹ˆæ˜¯å®éªŒè·Ÿè¸ªï¼Ÿ

å®éªŒè·Ÿè¸ªå°±æ˜¯å°†ä½ æ¯ä¸€æ¬¡æ¨¡å‹è®­ç»ƒçš„"å››ä»¶å¥—"ç³»ç»Ÿåœ°è®°å½•ä¸‹æ¥çš„è¿‡ç¨‹ï¼š
1.  **ä»£ç ç‰ˆæœ¬ (Code Version)**ï¼šä½ ç”¨äº†å“ªä¸ªç‰ˆæœ¬çš„ä»£ç ï¼Ÿ(ä¾‹å¦‚ï¼ŒGit commit hash)
2.  **è¾“å…¥æ•°æ® (Input Data)**ï¼šä½ ç”¨äº†å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®é›†ï¼Ÿ
3.  **è¶…å‚æ•° (Hyperparameters)**ï¼šæ¨¡å‹çš„å‚æ•°é…ç½®æ˜¯ä»€ä¹ˆï¼Ÿ(ä¾‹å¦‚ï¼Œ`LogisticRegression(C=0.5, solver='saga')`)
4.  **è¾“å‡ºç»“æœ (Output)**ï¼šæ¨¡å‹çš„æ€§èƒ½æŒ‡æ ‡ï¼ˆå¦‚F1åˆ†æ•°ï¼‰å’Œäº§å‡ºçš„æ¨¡å‹æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ

åƒ [MLflow](https://mlflow.org/) å’Œ [Weights & Biases](https://wandb.ai/) è¿™æ ·çš„å·¥å…·ï¼Œå°±æ˜¯ä¸“é—¨ä¸ºæ­¤è®¾è®¡çš„ã€‚å®ƒä»¬èƒ½å¸®ä½ åˆ›å»ºä¸€ä¸ª"å®éªŒæ—¥å¿—"ï¼Œè®©ä½ æ‰€æœ‰çš„å°è¯•éƒ½ä¸€ç›®äº†ç„¶ï¼Œæ–¹ä¾¿ä½ æ¯”è¾ƒã€å¤ç°å’Œåˆ†äº«ã€‚

### ä¸AIååŒï¼Œå¿«é€Ÿæ­å»ºä¸€ä¸ªåŸºç¡€å®éªŒè·Ÿè¸ªå™¨

è™½ç„¶åœ¨å…¥é—¨é˜¶æ®µæˆ‘ä»¬ä¸ä¸€å®šéœ€è¦å¼•å…¥ä¸€ä¸ªé‡å‹çš„å®éªŒè·Ÿè¸ªæ¡†æ¶ï¼Œä½†æˆ‘ä»¬å¯ä»¥åˆ©ç”¨AIï¼Œå¿«é€Ÿä¸ºæˆ‘ä»¬çš„ä»£ç å¢åŠ åŸºç¡€çš„å®éªŒè·Ÿè¸ªåŠŸèƒ½ã€‚è®©æˆ‘ä»¬æ¥æŒ‡æŒ¥AIå®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚

> **AIæŒ‡ä»¤æ¨¡æ¿ï¼šä¸ºè®­ç»ƒè„šæœ¬æ·»åŠ å®éªŒè·Ÿè¸ªåŠŸèƒ½**
>
> **# è§’è‰²**
> ä½ æ˜¯ä¸€ä½æ³¨é‡ä»£ç è§„èŒƒå’Œå¯å¤ç°æ€§çš„èµ„æ·±æœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆã€‚
>
> **# ä¸Šä¸‹æ–‡**
> æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªæ¨¡å‹è®­ç»ƒçš„è„šæœ¬ã€‚å®ƒèƒ½å¤Ÿè®­ç»ƒä¸€ä¸ªæ¨¡å‹å¹¶è¯„ä¼°å…¶æ€§èƒ½ã€‚ä½†æ¯æ¬¡è¿è¡Œï¼Œç»“æœéƒ½ä¼šè¢«è¦†ç›–ï¼Œæ— æ³•æ¯”è¾ƒä¸åŒå®éªŒã€‚
>
> **# ä»»åŠ¡**
> è¯·å¸®æˆ‘é‡æ„è¿™æ®µä»£ç ï¼ŒåŠ å…¥ä¸€ä¸ªåŸºç¡€çš„å®éªŒè·Ÿè¸ªåŠŸèƒ½ã€‚æˆ‘å¸Œæœ›å®ç°ä»¥ä¸‹ç›®æ ‡ï¼š
> 1.  **åˆ›å»ºä¸€ä¸ª`run_experiment`å‡½æ•°**ï¼šå°†å•æ¬¡æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°çš„é€»è¾‘å°è£…åœ¨è¿™ä¸ªå‡½æ•°é‡Œã€‚
> 2.  **è®°å½•å®éªŒç»“æœ**ï¼šå‡½æ•°åº”è¯¥è¿”å›ä¸€ä¸ªåŒ…å«å…³é”®ä¿¡æ¯çš„å­—å…¸ï¼Œä¾‹å¦‚ï¼š`model_name`, `accuracy`, `macro_f1_score`ï¼Œä»¥åŠè¯¦ç»†çš„ `classification_report`ã€‚
> 3.  **ç³»ç»ŸåŒ–è¿è¡Œå’Œæ¯”è¾ƒ**ï¼š
>     *   åˆ›å»ºä¸€ä¸ªåˆ—è¡¨`results_list`æ¥ä¿å­˜æ¯æ¬¡å®éªŒçš„ç»“æœã€‚
>     *   åœ¨ä¸€ä¸ªä¸»æµç¨‹ä¸­ï¼Œæˆ‘å¯ä»¥å®šä¹‰ä¸åŒçš„æ¨¡å‹ï¼ˆæ¯”å¦‚é€»è¾‘å›å½’å’ŒLightGBMï¼‰ï¼Œç„¶åå¾ªç¯è°ƒç”¨`run_experiment`å‡½æ•°ã€‚
>     *   æœ€åï¼Œå°†`results_list`è½¬æ¢ä¸ºä¸€ä¸ªPandas DataFrameï¼Œå¹¶æ‰“å°å‡ºæ¥ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥æ¸…æ™°åœ°æ¯”è¾ƒä¸åŒå®éªŒçš„ç»“æœã€‚
> 4.  **ä»£ç æ¨¡å—åŒ–**ï¼šè¯·å°†æ•°æ®åŠ è½½å’Œé¢„å¤„ç†çš„é€»è¾‘ä¹Ÿå°è£…æˆç‹¬ç«‹çš„å‡½æ•°ï¼Œè®©ä¸»è„šæœ¬æ›´æ¸…æ™°ã€‚
>
> **# åŸå§‹ä»£ç ç‰‡æ®µ (ç¤ºæ„)**
> ```python
> # æ•°æ®åŠ è½½...
> # ç‰¹å¾å·¥ç¨‹...
> # æ•°æ®åˆ‡åˆ†...
>
> # æ¨¡å‹1ï¼šé€»è¾‘å›å½’
> lr = LogisticRegression()
> lr.fit(X_train, y_train)
> y_pred_lr = lr.predict(X_test)
> print(classification_report(y_test, y_pred_lr))
>
> # æ¨¡å‹2ï¼šLightGBM (å¯èƒ½ä¹‹åä¼šåŠ )
> # lgb = lgb.LGBMClassifier()
> # lgb.fit(X_train, y_train)
> # y_pred_lgb = lgb.predict(X_test)
> # print(classification_report(y_test, y_pred_lgb))
> ```
>
> **# è¾“å‡ºæ ¼å¼**
> æä¾›ä¸€ä¸ªå®Œæ•´çš„ã€é‡æ„åçš„ã€å¯ä»¥ç›´æ¥è¿è¡Œçš„Pythonè„šæœ¬ã€‚

---

#### AIé‡æ„åçš„ä»£ç  (é¢„æœŸè¾“å‡º)

ä¸€ä¸ªå¥½çš„AIåŠ©æ‰‹ä¼šè¿”å›ä¸€ä¸ªç»“æ„æ¸…æ™°ã€æ¨¡å—åŒ–çš„è„šæœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
#| eval: false
#| code-fold: true
#| code-summary: "ç‚¹å‡»æŸ¥çœ‹AIé‡æ„åçš„å®Œæ•´å®éªŒè·Ÿè¸ªè„šæœ¬"
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from lightgbm import LGBMClassifier
from sklearn.metrics import classification_report, accuracy_score, f1_score
from sklearn.preprocessing import LabelEncoder

# --- 1. æ•°æ®å¤„ç†æ¨¡å— ---
def load_and_preprocess_data(filepath):
    """åŠ è½½æ•°æ®ï¼Œå¤„ç†ç¼ºå¤±å€¼ï¼Œå¹¶è¿›è¡Œæ ‡ç­¾ç¼–ç ã€‚"""
    data = pd.read_csv(filepath)
    data['content'] = data['content'].fillna('')
    
    label_encoder = LabelEncoder()
    data['label_encoded'] = label_encoder.fit_transform(data['label'])
    
    return data, label_encoder

def create_features(data):
    """ä½¿ç”¨TF-IDFåˆ›å»ºæ–‡æœ¬ç‰¹å¾ã€‚"""
    vectorizer = TfidfVectorizer(max_features=5000, stop_words='english')
    tfidf_matrix = vectorizer.fit_transform(data['content'])
    return tfidf_matrix, vectorizer

# --- 2. å®éªŒè¿è¡Œæ¨¡å— ---
def run_experiment(model, X_train, y_train, X_test, y_test, label_encoder):
    """è®­ç»ƒä¸€ä¸ªæ¨¡å‹å¹¶è¿”å›å…¶æ€§èƒ½æŒ‡æ ‡ã€‚"""
    model_name = model.__class__.__name__
    print(f"--- Running experiment for: {model_name} ---")
    
    # è®­ç»ƒ
    model.fit(X_train, y_train)
    
    # é¢„æµ‹
    y_pred = model.predict(X_test)
    
    # è¯„ä¼°
    accuracy = accuracy_score(y_test, y_pred)
    macro_f1 = f1_score(y_test, y_pred, average='macro')
    report = classification_report(y_test, y_pred, target_names=label_encoder.classes_, output_dict=True)
    
    # è®°å½•ç»“æœ
    result = {
        'model_name': model_name,
        'accuracy': accuracy,
        'macro_f1_score': macro_f1,
        'classification_report': report
    }
    
    print(f"--- Experiment for {model_name} finished. Macro F1: {macro_f1:.4f} ---\n")
    return result

# --- 3. ä¸»æµç¨‹ ---
if __name__ == '__main__':
    # åŠ è½½å’Œå‡†å¤‡æ•°æ®
    # æ³¨æ„ï¼šè¯·å°† 'aigc_content.csv' æ›¿æ¢ä¸ºä½ çš„æ•°æ®æ–‡ä»¶è·¯å¾„
    data, label_encoder = load_and_preprocess_data('aigc_content.csv')
    tfidf_matrix, vectorizer = create_features(data)
    
    # åˆ‡åˆ†æ•°æ®é›†
    X_train, X_test, y_train, y_test = train_test_split(
        tfidf_matrix, 
        data['label_encoded'], 
        test_size=0.2, 
        random_state=42, 
        stratify=data['label_encoded']
    )
    
    # å®šä¹‰è¦å°è¯•çš„æ¨¡å‹
    models_to_try = [
        LogisticRegression(max_iter=1000, random_state=42),
        LGBMClassifier(random_state=42)
    ]
    
    # è¿è¡Œæ‰€æœ‰å®éªŒå¹¶æ”¶é›†ç»“æœ
    results_list = []
    for model in models_to_try:
        exp_result = run_experiment(model, X_train, y_train, X_test, y_test, label_encoder)
        results_list.append(exp_result)
        
    # å°†ç»“æœè½¬æ¢ä¸ºDataFrameä»¥ä¾¿äºæ¯”è¾ƒ
    results_df = pd.DataFrame(results_list)
    
    # æå–æ¯ä¸ªç±»åˆ«çš„F1åˆ†æ•°ï¼Œæ–¹ä¾¿æ¯”è¾ƒ
    for label in label_encoder.classes_:
        results_df[f'f1_{label}'] = results_df['classification_report'].apply(lambda x: x[label]['f1-score'])
        
    # æ‰“å°æœ€ç»ˆçš„æ¯”è¾ƒè¡¨æ ¼ (å¯ä»¥æŒ‰æŸä¸ªå…³é”®æŒ‡æ ‡æ’åº)
    print("--- Experiment Comparison Summary ---")
    print(results_df[['model_name', 'accuracy', 'macro_f1_score', 'f1_æœ‰å®³', 'f1_ä½è´¨', 'f1_ä¼˜è´¨']].sort_values(by='macro_f1_score', ascending=False))

```
é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥è½»æ¾åœ°åœ¨`models_to_try`åˆ—è¡¨ä¸­æ·»åŠ æ›´å¤šæ¨¡å‹æˆ–ä¸åŒå‚æ•°çš„åŒä¸€æ¨¡å‹ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨è¿è¡Œã€è¯„ä¼°å¹¶ç”Ÿæˆä¸€ä¸ªæ¸…æ™°çš„å¯¹æ¯”è¡¨æ ¼ï¼Œè®©ä½ çš„æ¨¡å‹è¿­ä»£è¿‡ç¨‹å˜å¾—å‰æ‰€æœªæœ‰çš„ç³»ç»Ÿå’Œé«˜æ•ˆã€‚

::: 